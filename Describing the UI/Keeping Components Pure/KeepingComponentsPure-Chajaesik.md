# React는 순수한 함수로 이루어져 있다.
## 순수한 함수란?
- 작성되는 `React` 컴포넌트에 같은 입력이 주어진다면 반드시 같은 `JSX`를 반환한다는 것을 의미
- 연산만 하는 함수
- `React`에는 렌더링하면서 읽을 수 있는 세 가지 종류의 입력 요소가 있다. 
**props**, **state**, 그리고 **context**. 이러한 입력 요소는 항상 읽기전용으로 취급해야 한다.

#### 사이드 이펙트(의도하지 않은 결과)
예시

```javascript
let guest = 0;

function Cup() {
  // 나쁜 지점: 이미 존재했던 변수를 변경하고 있다!
  guest = guest + 1;
  return <h2>Tea cup for guest #{guest}</h2>;
}

export default function TeaSet() {
  return (
    <>
      <Cup /> 2
      <Cup /> 4
      <Cup /> 6
    </>
  );
}

// guest 변수를 전역변수가 아닌 프로퍼티로 넘겨 순수한 함수를 유지

function Cup({ guest }) {
    return <h2>Tea cup for guest #{guest}</h2>;
  }
  
  export default function TeaSet() {
    return (
      <>
        <Cup guest={1} />
        <Cup guest={2} />
        <Cup guest={3} />
      </>
    );
  }
 ```

### 다음은 local 변형에 관한 이야기이다.
예시)
 ```javascript
function Cup({ guest }) {
    return <h2>Tea cup for guest #{guest}</h2>;
  }
  
  export default function TeaGathering() {
    let cups = [];
    for (let i = 1; i <= 12; i++) {
      cups.push(<Cup key={i} guest={i} />); // 함수 내에서 선언되어 있기 때문에 지역 변형
    }
    return cups;
  }
 ```

#### 만약 cups 변수나 [] 배열이 `TeaGathering`의 바깥에서 생성되었다면 큰 문제가 된다
##### 왜냐하면 항목을 해당 배열에 푸시하여 기존 객체를 변경할 수 있기 때문이다.
##### 하지만, `TeaGathering`안에 동일한 렌더링중에 생성되었기 때문에 괜찮다. 
##### 이 현상은 “지역 변형” 이라 부른다.

 
### 위 코드는 렌더링하는 동안 그냥 만든 변수와 객체를 변경하는 것은 전혀 문제가 없다.

 

#### 그렇다면 bug를 발생시키지 않을까? 
 - 함수형 프로그래밍은 순수성에 크게 의존하지만 언젠간 어디서 무언가가 바뀌어야 한다.
 - 화면을 업데이트하고, 애니메이션을 시작하고, 데이터를 변경하는 변화들을 "사이드 이펙트"라고 한다.

### React에서 사이드이펙트는 보통 이벤트 핸들러에 포함된다.

##### 이벤트 핸들러는 `React`가 일부 작업을 수행할 때 반응하는 기능이다(버튼을 클릭할 때처럼)

##### 이벤트 핸들러가 컴포넌트 내부에 정의되었다 하더라도 랜더링 되는 중에는 실행되지 않기 때문에 순수할 필요가 없다.

##### 코딩하면서 사이드 이펙트에 적합한 이벤트 핸들러를 찾을 수 없는 경우에 컴폰넌트에서 `useEffect` 호출을 사용하여 반환된 `JSX`에 해당 이벤트 핸들러를 연결할 수 있다.

 

### React는 왜 순수성을 신경쓸까? 

#### 1. 예측 가능성: 순수 함수는 동일한 입력에 대해 항상 동일한 출력을 반환하기 때문에 코드의 예측 가능성을 높이고 버그를 줄인다.
#### 2. 성능 최적화: `React`는 상태를 불변으로 다루어 `Virtual DOM`을 통해 불필요한 렌더링을 방지하고 성능을 향상시킨다.
#### 3. 디버깅 용이성: 순수 함수는 사이드 이펙트가 없어 테스트와 디버깅이 용이하며, 함수형 프로그래밍 원칙을 통해 코드의 재사용성과 모듈성을 증대시킨다.

 

### React에서는 아래의 내용을 추천한다. 

##### 반환하는 JSX에서 컴포넌트의 로직을 표현하기 위해 노력하십시오. “무언가를 변경”해야 할 경우 일반적으로 이벤트 핸들러에서 변경하고 싶을 것입니다. 마지막 수단으로 `useEffect`를 사용할 수 있습니다.